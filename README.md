# DL_HSI_swift_classify

# 深度学习在高光谱像元分类上的敏捷化研究

本仓库致力于使用敏捷化深度学习方法对高光谱图像进行像元分类。目前已实现支持向量机（SVM）分类器，后续将增加神经网络、深度网络等分类模型。

## 项目简介

高光谱图像是一种具有丰富频谱信息的遥感图像，在很多领域有着广泛的应用，如农业、环境监测等。本项目旨在开发一套高效的像元分类方法，从而提高对高光谱图像的应用效果。
## 环境配置

本项目基于Python3.6开发，需要安装以下依赖包：

```text
numpy==1.24.2
scikit-learn==1.2.2
scipy==1.10.1
```

注意：包版本视实际情况而定，一下包版本为测试机使用的版本，其他版本未经过测试。
安装命令：
```commandline
pip install -r requirements.txt
```

## 代码结构与功能

主要代码结构如下：

```text
- utils.py：工具函数，包括加载数据集、波段降维等操作
- preprocess.py：数据预处理函数，包括数据划分、训练集与测试集构建等
- main.py：主程序，实现SVM分类器训练与预测

```

## 实验过程与结果

### 数据集

本项目使用的数据集为`IndianPines`。数据经过归一化处理后，再使用PCA方法降维。

### 训练与测试

采用70%的数据作为训练集，30%的数据作为测试集。使用SVM分类器进行训练与预测。

### 分类结果

输出分类报告与准确率。具体效果需根据实际运行结果查看。

## 后续计划

1. 实现神经网络分类模型
2. 实现深度网络分类模型
3. 对比各种分类模型的效果
4. 优化代码结构与功能

## 运行程序

该程序使用命令行参数来控制程序的行为。以下是可以使用的参数及其默认值：

- `--n_runs`：运行程序的次数，默认为 1。
- `--dataset`：数据集名称，默认为 'IndianPines'。
- `--preprocess`：数据预处理方法名称，默认为 `None`。
- `--model`：分类模型名称，默认为 'SVM'。
- `--sample_rate`：训练集样本比例，默认为 0.3。

你可以使用以下命令来运行程序：

SVM模型

```python
python main.py --dataset IndianPines --preprocess ICA --model SVM
```

在上面的示例中，我们将 `--n_runs` 参数设置为 3，`--dataset` 参数设置为 'IndianPines'，`--preprocess` 参数设置为 'ICA'，`--model` 参数设置为 'SVM'。你可以根据需要调整这些参数的值。

更多运行示例请参照[run_example.md](./run_examples.md)。


在程序中，使用 `argparse` 模块来解析命令行参数，并将其存储在相应的变量中。你可以使用这些变量来控制程序的行为。例如，使用 `n_runs` 变量来指定程序的运行次数，使用 `dataset_name` 变量来指定数据集名称等等。

运行结束后，将输出分类报告与准确率。

如：
SVM报告
```text
Classification Report:
               precision    recall  f1-score   support

           1       1.00      0.29      0.44        14
           2       0.65      0.69      0.67       428
           3       0.74      0.51      0.61       249
           4       0.67      0.20      0.30        71
           5       0.87      0.88      0.87       145
           6       0.93      0.97      0.95       219
           7       1.00      0.75      0.86         8
           8       0.95      1.00      0.97       143
           9       0.75      0.50      0.60         6
          10       0.69      0.71      0.70       292
          11       0.70      0.85      0.77       737
          12       0.79      0.53      0.64       178
          13       1.00      0.98      0.99        61
          14       0.91      0.96      0.93       380
          15       0.80      0.58      0.67       116
          16       1.00      0.96      0.98        28

    accuracy                           0.77      3075
   macro avg       0.84      0.71      0.75      3075
weighted avg       0.78      0.77      0.77      3075

Accuracy:  0.7746341463414634

```
